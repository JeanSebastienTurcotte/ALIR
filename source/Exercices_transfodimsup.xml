<?xml version="1.0" encoding="UTF-8"?>

<!-- Ce fichier constitue un fichier auxiliaire du livre                     -->
<!--                                                                        -->
<!--      Algèbre linéaire : Intuition et rigueur                           -->
<!--                                                                        -->
<!-- Copyright (C) 2019  Jean-Sébastien Turcotte, Philémon Turcotte         -->
<!-- Licence à venir                                                        -->

<exercises xmlns:xi="http://www.w3.org/2001/XInclude" xml:id="exo-transfodimsup">   <!-- Ajouter l'identifiant de la section après le - du xml:id -->
    <title> Exercices </title>
    <!--exercise xml:id="exo-">
            <introduction>
                <p>L'énoncé de l'exercice.</p>
            </introduction>
            <task>
            <statement>
                <p>La première lettre de la question.</p>
            </statement>
            <answer>
                <p> La réponse suivra. </p>
            </answer>
            <solution>
                <p> La solution suivra. </p>
            </solution>
            </task>
    </exercise>-->
    <exercise>
    <task>
    <statement>
    <p>Donner un exemple d'une matrice <m>3\times 5</m> qui ne possède pas d'inverse à gauche, mais qui possède un inverse à droite.</p>
    </statement>
    <answer>
    <p><me>A=\begin{pmatrix}1&amp;0&amp;0&amp;0&amp;0\\0&amp;1&amp;0&amp;0&amp;0\\0&amp;0&amp;1&amp;0&amp;0\end{pmatrix}</me></p>
    </answer>
    <solution>
    <p>La matrice <m>A=\begin{pmatrix}1&amp;0&amp;0&amp;0&amp;0\\0&amp;1&amp;0&amp;0&amp;0\\0&amp;0&amp;1&amp;0&amp;0\end{pmatrix}</m> possède un inverse à droite.
    Voici un exemple d'inverse à droite possible:
    <m>B=\begin{pmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\\0&amp;0&amp;0\\0&amp;0&amp;0\end{pmatrix}</m>.
    On vérifie qu'effectivement, on a <m>AB=I_3</m>:
    <md>
        <mrow>AB&amp;=\begin{pmatrix}1&amp;0&amp;0&amp;0&amp;0\\0&amp;1&amp;0&amp;0&amp;0\\0&amp;0&amp;1&amp;0&amp;0\end{pmatrix}
        \begin{pmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\\0&amp;0&amp;0\\0&amp;0&amp;0\end{pmatrix}</mrow>
        <mrow>&amp;=\begin{pmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\end{pmatrix}</mrow>
        <mrow>&amp;=I_3</mrow>
    </md>
    Le théorème <xref ref="thm-invrect"/> nous garanti que c'est impossible que cette matrice possède également un inverse à gauche. On a donc terminé.</p>
    </solution>
    </task>
    <task>
    <statement>
    <p>Donner pun exemple d'une matrice <m>4\times 2</m> qui ne possède pas d'inverse à droite, mais qui possède un inverse à gauche.</p>
    </statement>
    <answer>
    <p><me>A=\begin{pmatrix}1&amp;0\\0&amp;1\\0&amp;0\\0&amp;0\end{pmatrix}</me></p>
    </answer>
    <solution>
    <p>La matrice <m>A=\begin{pmatrix}1&amp;0\\0&amp;1\\0&amp;0\\0&amp;0\end{pmatrix}</m> possède un inverse à gauche.
    Voici un exemple d'inverse à gauche possible:
    <m>B=\begin{pmatrix}1&amp;0&amp;0&amp;0\\0&amp;1&amp;0&amp;0\end{pmatrix}</m>.
    On vérifie qu'effectivement, on a <m>BA=I_2</m>:
    <md>
        <mrow>BA&amp;=\begin{pmatrix}1&amp;0&amp;0&amp;0\\0&amp;1&amp;0&amp;0\end{pmatrix}\begin{pmatrix}1&amp;0\\0&amp;1\\0&amp;0\\0&amp;0\end{pmatrix}</mrow>
        <mrow>&amp;=\begin{pmatrix}1&amp;0\\0&amp;1\end{pmatrix}</mrow>
        <mrow>&amp;=I_2</mrow>
    </md>
    Le théorème <xref ref="thm-invrect"/> nous garanti que c'est impossible que cette matrice possède également un inverse à gauche. On a donc terminé.</p>
    </solution>
    </task>
    </exercise>
    <exercise>
    <task>
    <statement>
    <p>Trouver un inverse à gauche pour la matrice <m>A=\begin{pmatrix}
1 &amp; 0 \\
0 &amp; 2 \\
1 &amp; 0
 \end{pmatrix}</m></p>
    </statement>
    <answer>
    <p><me>
    A^{-1}_{\text{gauche}}=\begin{pmatrix}
2 &amp; 0 &amp; -1 \\
1 &amp; \frac{1}{2} &amp; -1
\end{pmatrix}
    </me></p>
    </answer>
    <solution>
    <p>Trouver un inverse juste comme ça sans trop avoir d'idée comment procéder peut sembler très difficile à première vue.
    Cependant, la matrice intiale est suffisamment simple et comporte beaucoup de zéros, ce qui rend la tâche plus facile, sans être évidente.
    La façon la plus systématique de procéder est de créer une matrice des bonnes dimensions avec des variables et de les multiplier. 
    On met le résultat égal à ce qu'on veut obtenir: la matrice identité de taille appropriée.
    On obtient alors un système d'équations à quatre équations six inconnues.
    <md>
        <mrow>A^{-1}_{\text{gauche}}A&amp;=\begin{pmatrix}
a &amp; c &amp; e \\
b &amp; d &amp; f
\end{pmatrix}\begin{pmatrix}
1 &amp; 0 \\
0 &amp; 2 \\
1 &amp; 0
 \end{pmatrix}</mrow>
         <mrow>&amp;=\begin{pmatrix}
a+e &amp; 2c \\
b+f &amp; 2d
\end{pmatrix}</mrow>
        <mrow>&amp;=\begin{pmatrix}
1 &amp; 0 \\
0 &amp; 1
\end{pmatrix}</mrow>
    </md>
    Ainsi, 
    <me>\begin{cases}a+e&amp;=1\\
    2c&amp;=0\\
    b+f&amp;=0\\
    2d&amp;=1\end{cases}
    \Rightarrow
    \begin{cases}a&amp;=1-e\\
    c&amp;=0\\
    b&amp;=-f\\
    d&amp;=\frac{1}{2}\end{cases}
    </me>
    En posant <m>e=-1</m> et <m>f=-1</m>, on obtient <m>a=2</m> et <m>b=1</m> et la matrice inverse à gauche est:
    <me>A^{-1}_{\text{gauche}}=\begin{pmatrix}
2 &amp; 0 &amp; -1 \\
1 &amp; \frac{1}{2} &amp; -1
\end{pmatrix}\text{.}</me>
    </p>
    </solution>
    </task>
    <task><statement><p>Trouver un inverse à droite pour la matrice <m>B=\begin{pmatrix}
0 &amp; 1 &amp; -1 \\
1 &amp; 0 &amp; 0
\end{pmatrix}</m></p></statement>
<answer><p><me>
B^{-1}_{\text{droite}}=\begin{pmatrix}
0 &amp; 1 \\
2 &amp; 1 \\
1 &amp; 1
\end{pmatrix}
</me></p></answer>
<solution>
<p>On procède de façon semblable. Voici la résolution algébrique:
<md>
        <mrow>BB^{-1}_{\text{droite}}&amp;=\begin{pmatrix}
0 &amp; 1 &amp; -1 \\
1 &amp; 0 &amp; 0
\end{pmatrix}\begin{pmatrix}
a &amp; d \\
b &amp; e \\
c &amp; f
 \end{pmatrix}</mrow>
         <mrow>&amp;=\begin{pmatrix}
b-c &amp; e-f \\
a &amp; d
\end{pmatrix}</mrow>
        <mrow>&amp;=\begin{pmatrix}
1 &amp; 0 \\
0 &amp; 1
\end{pmatrix}</mrow>
    </md>
    Ainsi, 
    <me>\begin{cases}b-c&amp;=1\\
    a&amp;=0\\
    e-f&amp;=0\\
    d&amp;=1\end{cases}
    \Rightarrow
    \begin{cases}b&amp;=1+c\\
    a&amp;=0\\
    e&amp;=f\\
    d&amp;=1\end{cases}
    </me>
    En posant <m>c=1</m> et <m>f=1</m>, on obtient <m>b=2</m> et <m>e=1</m> et la matrice inverse à droite est:
    <me>B^{-1}_{\text{droite}}=\begin{pmatrix}
0 &amp; 1 \\
2 &amp; 1 \\
1 &amp; 1
\end{pmatrix}\text{.}</me>
</p>
</solution>
</task>
<!--<task><statement>
<p>Lequel de ces deux inverses est le plus "difficile" à trouver? Pourquoi?
Réponse: Je ne sais pas sérieux! Je l'ai donc mis en commentaire...</p>
</statement></task>-->
    </exercise>
    <exercise>
    <statement><p>Soit <m>A</m> une matrice <m>m\times n</m> et <m>B</m> un inverse à droite de <m>A</m>. Montrer que <m>C</m> est aussi un inverse à droite
    pour <m>A</m> si et seulement si <m>A(B-C)=O</m> où les matrices sont de formats appropriés.</p></statement>
    <solution>
    <p>D'abord, soient <m>A</m> une matrice <m>m\times n</m> et <m>B</m> un inverse à droite de <m>A</m>.
    Par la définition <xref ref="def-invmn"/>, on sait que <m>AB=I_m</m>. 
    Le format de l'identité (<m>m\times m</m>) et de la matrice <m>B_{n \times m}</m> sont dictés par la multiplication matricielle.</p>
    <p>Si, dans un premier temps, <m>A(B-C)=O</m>, on a
    <md>
        <mrow>A(B-C)&amp;=O</mrow>
        <mrow>\Leftrightarrow AB-AC&amp;=O</mrow>
        <mrow>\Leftrightarrow I-AC&amp;=O</mrow>
        <mrow>\Leftrightarrow I&amp;=O+AC</mrow>
        <mrow>\Leftrightarrow AC&amp;=I</mrow>
    </md>
    Cela implique que <m>C</m> est un inverse à droite de <m>A</m>.
    </p>
    <p>Inversement, on n'a qu'à remonter et faire le raisonnement à l'envers puisqu'on a utilisé des équivalences tout le long.</p>
    </solution>
    </exercise>
    <exercise>
    <introduction><p>Soit <m>A,B,C</m> des matrices carrées <m>n\times n</m> telles que
    <ul>
    <li><p><m>A, A-AB </m> et <m>B</m>  sont inversibles</p></li>
    <li><p><m>(A-AB)^{-1}=B^{-1}C</m>.</p></li>
    </ul></p></introduction>
    <task>
    <statement><p>Montrer que la matrice <m>C</m> est inversible</p></statement>
    <hint>
    <p>On comprend le mot inversible partout dans la question dans le sens de la définition <xref ref="def-matcarreeinverse"/> qu'il convient de relire avant de commencer.</p>
    </hint>
    <solution>
        <p>Par la définition <xref ref="def-matcarreeinverse"/> et les hypothèses du problème, les matrices <m>A, A-AB </m> et <m>B</m> possèdent des inverses (à droite et à gauche)
        que l'on note, respectivement <m>A^{-1}, (A-AB)^{-1} </m> et <m>B^{-1}</m>.
        Pour démontrer que <m>C</m> est inversible, il faut montrer qu'il existe une matrice <m>C^{-1}</m> telle que <m>CC^{-1}=C^{-1}C=I</m>.
        En fait, par le théorème <xref ref="thm-invgauchedroite"/>, on n'a qu'à montrer un des deux côtés.
        On part de l'équation donnée et on tente d'obtenir la défintion de l'inverse :
        <md>
            <mrow>(A-AB)^{-1}&amp;=B^{-1}C</mrow>
            <mrow>(A-AB)(A-AB)^{-1}&amp;=(A-AB)B^{-1}C</mrow>
            <mrow>I&amp;=(AB^{-1}-ABB^{-1})C</mrow>
            <mrow>I&amp;=(AB^{-1}-AI)C</mrow>
            <mrow>I&amp;=A(B^{-1}-I)C</mrow>
        </md>
        On a obtenu une matrice <m>C^{-1}=A(B^{-1}-I)</m> telle que <m>C^{-1}C=I</m> et donc <m>C</m> est inversible.
        </p>
    </solution>
    </task>
    <task><statement><p>Exprimer <m>C</m> et <m>C^{-1}</m> en fonction de <m>A,B, I</m> et leur inverse.</p></statement>
    <answer>
        <p><me>C=B(A-AB)^{-1} \text{ et }C^{-1}=A(B^{-1}-I)</me></p>
    </answer>
    <solution>
        <p>On a pas mal déjà obtenu ces matrices dans la preuve préccédente.
        On peut simplement isoler <m>C</m> de l'équation intiale donnée en multipliant à gauche par <m>B</m> et on avait trouvé une expression pour <m>C^{-1}</m>.
        <me>C=B(A-AB)^{-1} \text{ et }C^{-1}=A(B^{-1}-I)</me></p>
    </solution></task>
    </exercise>
    <exercise xml:id="exo-invspecial">
    <statement><p>En utilisant la définition du produit matriciel <xref ref="def-matmatprod"/>, déterminer l'inverse des matrices
    <md>
    <mrow>A_3=\begin{pmatrix}1&amp; 0&amp; 0\\ 1&amp; 1&amp; 0\\ 1&amp; 1&amp; 1 \end{pmatrix}</mrow>
    <mrow>A_4=\begin{pmatrix}1&amp; 0&amp; 0 &amp; 0\\ 1&amp; 1&amp; 0 &amp; 0\\ 1&amp; 1&amp; 1 &amp; 0\\ 1&amp; 1 &amp; 1 &amp; 1 \end{pmatrix}</mrow>
    </md>.
    Quel serait un inverse pour
    <me>
    A_n=\begin{pmatrix} 1&amp; 0&amp; 0&amp; \cdots &amp; 0\\
                        1&amp; 1&amp; 0 &amp; \cdots &amp; 0\\
                        \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
                        1&amp; 1 &amp; 1 &amp; \cdots &amp; 1\end{pmatrix}
    </me>?
    </p></statement>
    <hint><p>Considérer la l'équation <m>AA^{-1}=I</m> et déterminer colonne par colonne les entrées de <m>A^{-1}</m>.</p></hint>
    <answer>
        <p><me>A^{-1}_3=\begin{pmatrix}1&amp; 0&amp; 0\\ -1&amp; 1&amp; 0\\ 0&amp; -1&amp; 1 \end{pmatrix}</me>
        <me>A^{-1}_4=\begin{pmatrix}1&amp; 0&amp; 0&amp;0\\ -1&amp; 1&amp; 0&amp;0\\ 0&amp; -1&amp; 1&amp;0 \\0&amp; 0&amp; -1&amp; 1\end{pmatrix}</me>
        <me>A^{-1}_n=\begin{pmatrix} 1&amp;0&amp; 0&amp; 0&amp; \cdots &amp; 0&amp; 0\\
                        -1&amp; 1&amp; 0 &amp;0&amp; \cdots &amp; 0&amp; 0\\
                        0&amp;-1&amp; 1&amp; 0&amp; \cdots &amp; 0&amp; 0\\
                        \vdots &amp; \vdots &amp; \vdots &amp;\vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
                        0&amp; 0 &amp; 0 &amp;0 &amp; \cdots &amp; -1 &amp; 1\end{pmatrix}</me></p>
    </answer>
    <solution>
        <p>On procède comme conseillé dans l'indication. On commence par <m>A_3</m>.
        Pour simplifier la notation, on utilise la notation donnée dans la définition <xref ref="def-matmatprod"/> à chaque matrice. 
        Soit <m>B_3</m>, la matrice inverse voulue. 
        On sait que
        <me>A_3B_3=\begin{pmatrix}
     \lvert &amp; \lvert &amp; \cdots &amp; \lvert \\
     A_3\vec{b}_1 &amp; A_3\vec{b}_2 &amp;\cdots &amp; A_3\vec{b}_n \\
     \lvert &amp; \lvert &amp; \cdots &amp; \lvert \\
     \end{pmatrix}=I_3=\begin{pmatrix}
     1&amp;0&amp;0\\
     0&amp;1&amp;0\\
     0&amp;0&amp;1
     \end{pmatrix}\text{.}</me>
        Alors, on calcule la première colonne:
        <me>\begin{pmatrix}1&amp; 0&amp; 0\\ 1&amp; 1&amp; 0\\ 1&amp; 1&amp; 1 \end{pmatrix}\vecddd{a}{b}{c}=\vecddd{1}{0}{0}\text{.}</me>
        On obtient les équations:
        <me>\begin{cases}a&amp;=1\\a+b&amp;=0\\a+b+c&amp;=0\end{cases}\Rightarrow \begin{cases}a&amp;=1\\b&amp;=-1\\c&amp;=0\end{cases}\Rightarrow \vec{b}_1=\vecddd{1}{-1}{0}</me>
        On calcule ensuite la deuxième colonne de façon semblable et on obtient:
        <me>\vec{b}_2=\vecddd{0}{1}{-1}\text{.}</me>
        Finalement, 
        <me>\vec{b}_3=\vecddd{0}{0}{1}\text{.}</me>
        Ce qui donne 
        <me>A^{-1}_3=B_3=\begin{pmatrix}
     \lvert &amp; \lvert &amp; \cdots &amp; \lvert \\
     \vec{b}_1 &amp; \vec{b}_2 &amp;\cdots &amp; \vec{b}_n \\
     \lvert &amp; \lvert &amp; \cdots &amp; \lvert \\
     \end{pmatrix}=\begin{pmatrix}1&amp; 0&amp; 0\\ -1&amp; 1&amp; 0\\ 0&amp; -1&amp; 1 \end{pmatrix}\text{.}</me>
     On obtient <m>A^{-1}_4</m> avec une démarche semblable:
     <me>A^{-1}_4=\begin{pmatrix}1&amp; 0&amp; 0&amp;0\\ -1&amp; 1&amp; 0&amp;0\\ 0&amp; -1&amp; 1&amp;0 \\0&amp; 0&amp; -1&amp; 1\end{pmatrix}\text{.}</me>
     On remarque la tendance. On peut donc conclure avec pas mal de confiance que :
     <me>A^{-1}_n=\begin{pmatrix} 1&amp;0&amp; 0&amp; 0&amp; \cdots &amp; 0&amp; 0\\
                        -1&amp; 1&amp; 0 &amp;0&amp; \cdots &amp; 0&amp; 0\\
                        0&amp;-1&amp; 1&amp; 0&amp; \cdots &amp; 0&amp; 0\\
                        \vdots &amp; \vdots &amp; \vdots &amp;\vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
                        0&amp; 0 &amp; 0 &amp;0 &amp; \cdots &amp; -1 &amp; 1\end{pmatrix}\text{.}</me>
        </p>
    </solution>
    </exercise>
    <exercise xml:id="exo-rotR3x">
            <statement>
                <p>Déterminer la matrice d'une rotation dans <m>\R^3</m> autour de l'axe des <m>x</m>. Ceci complètera l'exemple <xref ref="ex-rotR3axes"/>. La figure <xref ref="fig-rotR3axes"/>
                pourra  être utile.</p>
            </statement>
            <answer>
                <p><me>R_{\theta_x}=\begin{pmatrix} 1 &amp; 0&amp; 0  \\
                                 0 &amp; \cos(\theta) &amp; -\sin(\theta) \\
                                 0&amp;\sin(\theta) &amp;  \cos(\theta)\end{pmatrix}</me></p>            
            </answer>
            <solution>
                <p>Selon la séquence, l'angle sera mesuré de l'axe des <m>y</m> positifs vers l'axe des <m>z</m> positifs.
    Évidemment, l'image du vecteur <m>(1,0,0)</m> est lui-même puisque celui-ci est sur l'axe de rotation.</p>
    <p>On commence par trouver l'image du vecteur <m>(0,1,0)</m>. La figure <xref ref="fig-rotR3axes"/> peut être pratique pour visualiser. Un clic sur <em>rotation selon l'axe des </em> <m>x</m> fera apparaitre
    l'image du vecteur <m>(0,1,0)</m>. L'image du vecteur <m>(0,1,0)</m> est <m>(0,\cos(\theta),\sin(\theta))</m>.</p>
    <p>Comme le vecteur <m>(0,0,1)</m> est perpendiculaire au vecteur <m>(0,1,0)</m> dans le sens antihoraire, son image sera perpendiculaire à <m>(0,\cos(\theta),\sin(\theta))</m>, aussi dans le sens anithoraire 
    et sera aussi dans le plan <m>x=0</m>. En suivant un raisonnement similaire à celui de l'exemple <xref ref="ex-rotr2"/>, on obtient <m>R_{\theta_x}(0,0,1)=(0,-\sin(\theta),\cos(\theta))</m>. La matrice
    est donc
    <men xml:id="eq-rotR3x">
    R_{\theta_x}=\begin{pmatrix} 1 &amp; 0&amp; 0  \\
                                 0 &amp; \cos(\theta) &amp; -\sin(\theta) \\
                                 0&amp;\sin(\theta) &amp;  \cos(\theta)\end{pmatrix}
                                 </men>.</p>
    </solution>
    </exercise>
    
    <exercise>
    <statement><p>Dans <m>\R^2</m>, si <m>R_{\theta_1}</m> et <m>R_{\theta_2}</m> sont deux matrices de rotation, alors <m>R_{\theta_1}R_{\theta_2}=R_{\theta_2}R_{\theta_1}</m>.
    Est-ce aussi vrai dans <m>\R^3</m>? Si oui, pourquoi et si non, donner un exemple.</p></statement>
    <answer>
    <p>En général, ce ne sera pas commutatif. Par exemple, une rotation de <m>\frac{\pi}{2}</m> selon l'axe des <m>x</m> et une rotation de <m>\frac{\pi}{2}</m> selon l'axe des <m>z</m>.</p>
    </answer>
    <solution>
    <p>Voici une animation qui permet de visualier les transformations données dans la réponse.
    </p>
    <figure xml:id="fig-rotR3noncom">
      <caption>Les rotations dans <m>\R^3</m> ne sont pas commutatives en général</caption>
      <interactive aspect="1:1" platform="geogebra" width="100%"
      xml:id="geog-RotR3noncom">
        <slate aspect="1:1" source="code/geogebra/RotR3noncom.ggb"
        surface="geogebra" xml:id="slate-RotR3noncom">
            setCoordSystem(-5, 5,-5,5,-5,5);
          </slate>
        <instructions>
          <p>Un clic sur les boutons de rotation les effectuera selon l'ordre spécifié. Le bouton réinitialisé permet de mettre le cube en position initiale sans démarrer d'animation. 
          </p>
        </instructions>
        </interactive>
    </figure>
    </solution>
    </exercise>
    <exercise>
    <introduction>
    <p>L'effet d'un cisaillement horizontal ou vertical a été illustré à l'exercice <xref ref="exo-cisaillement"/>. Qu'en est-il des cisaillements dans <m>\R^3</m>?
    Algébriquement, on peut voir l'effet d'un cisaillement selon l'un des axes comme l'ajout d'un multiple d'une coordonnée à l'autre. Ainsi, le cisaillement 
    <m>\begin{pmatrix} 1 &amp; 2 \\ 0 &amp;1\end{pmatrix}</m> a pour effet d'ajouter à la composante <m>1</m> deux fois la composante <m>2</m>:
    <me>
    \begin{pmatrix} 1 &amp; 2 \\ 0 &amp;1\end{pmatrix}\vecd{x}{y}=\vecd{x+2y}{y}
    </me>.
    </p>
    <p>Pour avoir un comportement analogue dans <m>\R^3</m>, deux situations sont possibles:
    <ol>
    <li><p>On veut ajouter un multiple d'une seule composante à une autre composante;</p></li>
    <li><p>On veut ajouter des multiples des autres composantes à une composante.</p></li>
    </ol></p>
    </introduction>
    <task>
    <statement>
    <p>Soit <m>C_{xy,k},C_{xz,k}</m> les transformations qui ajoutent à la composante <m>x</m> respectivement <m>k</m> fois la composante en <m>y</m> ou <m>z</m>. D'une 
    manière analogue, on définit les transformations <m>C_{yx,k}, C_{yz,k}, C_{zx,k}, C_{zy,k}</m></p>
    <p>Donner la matrice de chacune de ces six transformations.</p>
    </statement>
    <answer>
        <p><me>C_{xy,k}=\begin{pmatrix} 1 &amp; k&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{xz,k}=\begin{pmatrix} 1 &amp; 0&amp;k \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{yx,k}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ k &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{yz,k}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;k\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{zx,k}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\k &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{zy,k}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; k&amp;1\end{pmatrix}</me></p>
    </answer>
    <solution>
        <p>La transformation <m>C_{xy,k}</m> est définie ainsi:
        <me>C_{xy,k}\vecddd{x}{y}{z}=\vecddd{x+ky}{y}{z}\text{.}</me>
        On peut donc inférer facilement, par la multiplication matrice-vecteur en lignes <xref ref="eq-matvecprodgeneral"/>, que la matrice est:
        <me>C_{xy,k}=\begin{pmatrix} 1 &amp; k&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}\text{.}</me>
        De façon semblable, on obtient toutes les autres matrices.
        <me>C_{xz,k}\vecddd{x}{y}{z}=\vecddd{x+kz}{y}{z}\Rightarrow C_{xz,k}=\begin{pmatrix} 1 &amp; 0&amp;k \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{yx,k}\vecddd{x}{y}{z}=\vecddd{x}{y+kx}{z}\Rightarrow C_{yx,k}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ k &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{yz,k}\vecddd{x}{y}{z}=\vecddd{x}{y+kz}{z}\Rightarrow C_{yz,k}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;k\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{zx,k}\vecddd{x}{y}{z}=\vecddd{x}{y}{z+kx}\Rightarrow C_{zx,k}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\k &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{zy,k}\vecddd{x}{y}{z}=\vecddd{x}{y}{z+ky}\Rightarrow C_{zy,k}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; k&amp;1\end{pmatrix}</me>
    </p>
    </solution>
    </task>
    <task>
    <statement><p>On veut maintenant définir trois cisaillements pour lesquels on ajoute à une composante des multiples des deux autres composantes. Quelles
    seraient une notation appropriée et la matrice de ces transformations?</p></statement>
    <answer>
        <p>
        <me>C_{x(y,k_1),(z,k_2)}=\begin{pmatrix} 1 &amp; k_1&amp;k_2 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{y(x,k_1),(z,k_2)}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ k_1 &amp;1&amp;k_2\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{z(x,k_1),(y,k_2)}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\k_1 &amp; k_2&amp;1\end{pmatrix}</me>
        </p>
    </answer>
    <solution>
        <p>On propose la notation <m>C_{x(y,k_1),(z,k_2)}</m> pour le cisaillement pour lequel on ajoute à la composante <m>x</m> un multiple des deux autres composantes.
        En suivant le raisonnement précédent, il est logique que la matrice de cisaillement soit:
        <me>C_{x(y,k_1),(z,k_2)}=\begin{pmatrix} 1 &amp; k_1&amp;k_2 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}\text{.}</me>
        Les deux autres matrices seront donc:
        <me>C_{y(x,k_1),(z,k_2)}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ k_1 &amp;1&amp;k_2\\0 &amp; 0&amp;1\end{pmatrix}</me>
        et
        <me>C_{z(x,k_1),(y,k_2)}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\k_1 &amp; k_2&amp;1\end{pmatrix}\text{.}</me>
        </p>
    </solution>
    </task>
    <task>
    <statement><p>Pour chacun des cisaillements, déterminer sans calculer l'inverse de la transformation. Justifier.</p></statement>
    <answer>
        <p>
        <me>C_{xy,k}^{-1}=\begin{pmatrix} 1 &amp; -k&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{xz,k}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;-k \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{yx,k}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ -k &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{yz,k}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;-k\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{zx,k}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\-k &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{zy,k}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; -k&amp;1\end{pmatrix}</me>
        <me>C_{x(y,k_1),(z,k_2)}^{-1}=\begin{pmatrix} 1 &amp; -k_1&amp;-k_2 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{y(x,k_1),(z,k_2)}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ -k_1 &amp;1&amp;-k_2\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{z(x,k_1),(y,k_2)}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\-k_1 &amp; -k_2&amp;1\end{pmatrix}</me>
        </p>
    </answer>
    <solution>
        <p>Logiquement, les transformations inverses seront toujours les transformations où au lieu d'additionner des multiples d'autres composantes, 
        on va soustraire ces multiples pour annuler l'effet. 
        Par exemple, pour le cisaillement <me>C_{xy,k}=\begin{pmatrix} 1 &amp; k&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}\text{,}</me> on propose
        que la matrice inverse est: 
        <me>C_{xy,k}^{-1}=\begin{pmatrix} 1 &amp; -k&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}\text{.}</me>
        On vérifie en multipliant les deux matrices ensemble et on obtient la matrice identité.
        <md>
            <mrow>C_{xy,k}C_{xy,k}^{-1}&amp;=\begin{pmatrix} 1 &amp; k&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}
            \begin{pmatrix} 1 &amp; -k&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</mrow>
            <mrow>&amp;=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</mrow>
        </md>
        On donne les autres matrices des transformations inverses.
        <me>C_{xz,k}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;-k \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{yx,k}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ -k &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{yz,k}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;-k\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{zx,k}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\-k &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{zy,k}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\0 &amp; -k&amp;1\end{pmatrix}</me>
        <me>C_{x(y,k_1),(z,k_2)}^{-1}=\begin{pmatrix} 1 &amp; -k_1&amp;-k_2 \\ 0 &amp;1&amp;0\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{y(x,k_1),(z,k_2)}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ -k_1 &amp;1&amp;-k_2\\0 &amp; 0&amp;1\end{pmatrix}</me>
        <me>C_{z(x,k_1),(y,k_2)}^{-1}=\begin{pmatrix} 1 &amp; 0&amp;0 \\ 0 &amp;1&amp;0\\-k_1 &amp; -k_2&amp;1\end{pmatrix}</me>
        </p>
    </solution>
    </task>
    </exercise>
    <exercisegroup>
    <title>Exercices Sage</title>
    <introduction>
    <p>Les exercices qui suivent sont faits pour être résolus avec Sage. Des cellules vides sont disponibles pour écrire les réponses. Évidemment, il y a plusieurs manières d'arriver aux réponses.</p>   
    </introduction>
    <exercise xml:id="exo-refR3" >
            <introduction>
                <p>On considère le plan d'équation normale <m>x+2y-3z=0</m>. On cherche à déterminer la matrice de réflexion autour de ce plan.</p>
            </introduction>
            <task>
            <statement>
                <p>Dans un premier temps, utiliser le principe derrière l'équation <xref ref="eq-matparvecteursuv"/> pour trouver la matrice de la transformation
                en considérant l'image de trois vecteurs spécifiques.</p>
            <sage>
            <input>
    
            </input>
            </sage>
            </statement>
            <hint>
                <p>Considérer le vecteur normal et deux vecteurs directeurs quelconques.</p>
            </hint>
            <answer>
                <p><me>T=\begin{pmatrix}\frac{6}{7}&amp;-\frac{2}{7}&amp;\frac{3}{7}\\-\frac{2}{7}&amp;\frac{3}{7}&amp;\frac{6}{7}\\ \frac{3}{7}&amp;\frac{6}{7}&amp;-\frac{2}{7}\end{pmatrix}</me>
               </p>
            </answer>
            <solution>
                <p>On considère les trois vecteurs suivants: le vecteur normal <m>\vec{n}=(1,2,-3)</m> et deux vecteurs directeurs quelconques <m>\vec{v}_1=(3,0,1)</m> et <m>\vec{v}_2=(2,-1,0)</m>.
                Remarquer que les vecteurs directeurs ont été <em>devinés</em> simplement en cherchant des valeurs de <m>(x,y,z)</m> qui fonctionnent dans l'équation normale. 
                On connait l'effet de cette réflexion sur ces trois vecteurs. 
                En effet, le vecteur normal sera transformé en son vecteur opposé et les vecteurs directeurs ne bougeront pas puisqu'ils sont dans le plan de réflexion.
                Ainsi,
                <me>T(\vec{n})=T\vecddd{1}{2}{-3}=\vecddd{-1}{-2}{3}\text{, }T(\vec{v}_1)=T\vecddd{3}{0}{1}=\vecddd{3}{0}{1}\text{, }T(\vec{v}_2)=T\vecddd{2}{-1}{0}=\vecddd{2}{-1}{0}</me>
                On résume tout cela sous forme matricielle où <m>U</m> est la matrice des vecteurs initiaux et <m>V</m> celle des vecteurs transformés et on isole la matrice de <m>T</m>.
                <md>
                    <mrow>TU&amp;=V</mrow>
                    <mrow>T\begin{pmatrix}1&amp;3&amp;2\\2&amp;0&amp;-1\\-3&amp;1&amp;0\end{pmatrix}&amp;=\begin{pmatrix}-1&amp;3&amp;2\\-2&amp;0&amp;-1\\3&amp;1&amp;0\end{pmatrix}</mrow>
                    <mrow>T&amp;=\begin{pmatrix}-1&amp;3&amp;2\\-2&amp;0&amp;-1\\3&amp;1&amp;0\end{pmatrix}\begin{pmatrix}1&amp;3&amp;2\\2&amp;0&amp;-1\\-3&amp;1&amp;0\end{pmatrix}^{-1}</mrow>
                </md>
                Le calcul de l'inverse d'une matrice <m>3\times 3</m> n'a pas été fait explicitement dans les exemples. 
                On pourrait procéder comme dans l'exemple <xref ref="ex-matinverse3"/>, mais cela nous mènerait à résoudre trois systèmes d'équations linéaires à 3 équations et 3 inconnues chacun.
                On verra dans le chapitre <xref ref="chap-SEL"/> comment y arriver de façon efficace. Pour l'instant, on a fait les calculs avec Sage.</p>
                <listing>
                   <caption>Le code solution pour l'exercice</caption>
               <program language="sage">
               <input>
U=matrix([[1,3,2],[2,0,-1],[-3,1,0]])
V=matrix([[-1,3,2],[-2,0,-1],[3,1,0]])
Uinv=U.inverse()
show("U=",U)
show("V=",V)
show("U^(-1)=",Uinv)
show("T=",V*Uinv)
               </input>
                   </program>
                   </listing>
                   <p>La matrice de <m>T</m> est donc:
                   <me>T=\begin{pmatrix}\frac{6}{7}&amp;-\frac{2}{7}&amp;\frac{3}{7}\\-\frac{2}{7}&amp;\frac{3}{7}&amp;\frac{6}{7}\\ \frac{3}{7}&amp;\frac{6}{7}&amp;-\frac{2}{7}\end{pmatrix}</me>
                </p>
            </solution>
            </task>
            <task>
            <statement>
                <p>Déterminer directement la matrice en calculant l'image des vecteurs <m>(1,0,0),(0,1,0),(0,0,1)</m>. 
                Pour cela, considérer la projection orthogonale de ces vecteurs sur le plan. 
                La figure <xref ref="fig-distpd"/> peut être utile, en considérant la droite comme le plan vu dans une certaine perspective.</p>
            <sage>
            <input>
    
            </input>
            </sage>
            </statement>
            <answer>
                <p><me>T=\begin{pmatrix}\frac{6}{7}&amp;-\frac{2}{7}&amp;\frac{3}{7}\\-\frac{2}{7}&amp;\frac{3}{7}&amp;\frac{6}{7}\\ \frac{3}{7}&amp;\frac{6}{7}&amp;-\frac{2}{7}\end{pmatrix}</me>
               </p>
            </answer>
            <solution>
                <p>La projection orthogonale sur le plan pour chaque vecteur s'obtient en considérant d'abord la projection sur le vecteur normal.
                En effet, si on utilise la lettre <m>\mathcal{P}</m> pour désigner le plan de réflexion, 
                <me>\vec{u}_{\mathcal{P}}=\vec{u}-\vec{u}_{\vec{n}}\text{.}</me>
                Une fois qu'on a obtenu la projection sur le plan <m>\mathcal{P}</m>, le vecteur transformé sera obtenu par 
                <md>
                <mrow>T(\vec{u})&amp;=-(\vec{u}-\vec{u}_{\mathcal{P}})+\vec{u}_{\mathcal{P}}</mrow>
                <mrow>&amp;=-(\vec{u}-(\vec{u}-\vec{u}_{\vec{n}}))+\vec{u}-\vec{u}_{\vec{n}}</mrow>
                <mrow>&amp;=\vec{u}-2\vec{u}_{\vec{n}} \text{ (en simplifiant)}</mrow>
                </md>
                La dernière équation nous porte à croire qu'il aurait été beaucoup plus simple de visualiser uniquement en fonction de la projection sur le vecteur normal plutôt que sur le plan.
                On effectuera ensuite tous les calculs sur Sage pour trouver les images des trois vecteurs. On rappelle la formule <xref ref="eq-projortho"/> pour la projection.</p>
                <listing>
                   <caption>Le code solution pour l'exercice</caption>
               <program language="sage">
               <input>
i=vector([1,0,0])
j=vector([0,1,0])
k=vector([0,0,1])
n=vector([1,2,-3])
Ti=i-2*((i*n)/(n*n))*n #la réflexion de (1,0,0) sur le plan, qui utilise la projection orthogonale
Tj=j-2*((j*n)/(n*n))*n
Tk=k-2*((k*n)/(n*n))*n
T=column_matrix([Ti,Tj,Tk]) #on met les résultats en colonnes pour obtenir T
show(T)
               </input>
               </program>
               </listing>
               <p>La matrice de <m>T</m> est donc:
                   <me>T=\begin{pmatrix}\frac{6}{7}&amp;-\frac{2}{7}&amp;\frac{3}{7}\\-\frac{2}{7}&amp;\frac{3}{7}&amp;\frac{6}{7}\\ \frac{3}{7}&amp;\frac{6}{7}&amp;-\frac{2}{7}\end{pmatrix}</me>
            </p></solution>
            </task>
            <task>
            <statement>
                <p>Répéter les démarches précédentes avec le plan <m>(x,y,z)=(1,2,-1)+r(-1,2,1)+s(3,0,-4)</m>.</p>
                <sage>
            <input>
    
            </input>
            </sage>
            </statement>
            <answer>
                <p><me>T=\begin{pmatrix}-\frac{27}{101}&amp;-\frac{16}{101}&amp;-\frac{96}{101}\\-\frac{16}{101}&amp;\frac{99}{101}&amp;-\frac{12}{101}\\ 
                   -\frac{96}{101}&amp;-\frac{12}{101}&amp;\frac{29}{101}\end{pmatrix}</me></p>
            </answer>
            <solution>
                <p>Les démarches seront les mêmes, mais on doit rajouter une étape au début.
                En effet, notre plan est défini par son équation vectorielle. 
                Il nous faut trouver un vecteur normal pour effectuer nos projections.</p>
                <listing>
                   <caption>Le code solution pour trouver le vecteur normal</caption>
               <program language="sage">
               <input>
var("x,y,z")
v1=vector([-1,2,1])
v2=vector([3,0,-4])
#Le vecteur voulu n est solution des deux équations suivantes puisqu'il est perpendiculaire aux deux vecteurs directeurs en même temps
sol=solve([v1*vector([x,y,z])==0,v2*vector([x,y,z])==0],x,y,z,solution_dict=True) 
show("n=",sol)
#La procédure suivante permet de remplacer la variable libre par une valeur choisie, disons 6 pour éviter les fractions
l=[] #Liste vide des variables libres
for v in sol[0].keys():  # vérifier ce que sol[0].keys() donne pour comprendre cette étape
    for var in sol[0][v].variables():  #Vérifier aussi cette étape
        if var not in l:   #On ne veut pas que les variables soient la plusieurs fois
            l.append(var)
n=vector([sol[0][x],sol[0][y],sol[0][z]]).subs({l[0]:6})
show("n=",n)
               </input>
               </program>
               </listing>
                <p>On considère les trois vecteurs suivants: le vecteur normal <m>\vec{n}=(8,1,6)</m> et deux vecteurs directeurs quelconques <m>\vec{v}_1=(-1,2,1)</m> et <m>\vec{v}_2=(3,0,-4)</m>.
                En effet, le vecteur normal sera transformé en son vecteur opposé et les vecteurs directeurs ne bougeront pas puisqu'ils sont dans le plan de réflexion.
                Ainsi,
                <me>T(\vec{n})=T\vecddd{8}{1}{6}=\vecddd{-8}{-1}{-6}\text{, }T(\vec{v}_1)=T\vecddd{-1}{2}{1}=\vecddd{-1}{2}{1}\text{, }T(\vec{v}_2)=T\vecddd{3}{0}{-4}=\vecddd{3}{0}{-4}</me>
                On résume tout cela sous forme matricielle où <m>U</m> est la matrice des vecteurs initiaux et <m>V</m> celle des vecteurs transformés et on isole la matrice de <m>T</m>.
                On a fait les calculs avec Sage.</p>
                <listing>
                   <caption>Le code solution pour l'exercice</caption>
               <program language="sage">
               <input>
U=matrix([[8,-1,3],[1,2,0],[6,1,-4]])
V=matrix([[-8,-1,3],[-1,2,0],[-6,1,-4]])
Uinv=U.inverse()
show("U=",U)
show("V=",V)
show("U^(-1)=",Uinv)
show("T=",V*Uinv)
               </input>
                   </program>
                   </listing>
                   <p>La matrice de <m>T</m> est donc:
                   <me>T=\begin{pmatrix}-\frac{27}{101}&amp;-\frac{16}{101}&amp;-\frac{96}{101}\\-\frac{16}{101}&amp;\frac{99}{101}&amp;-\frac{12}{101}\\ 
                   -\frac{96}{101}&amp;-\frac{12}{101}&amp;\frac{29}{101}\end{pmatrix}</me>
                   </p>
                   <p>Alternativement, la projection orthogonale sur le plan pour chaque vecteur s'obtient en considérant d'abord la projection sur le vecteur normal.
                   On avait obtenu la formule:
                   <me>T(\vec{u})=\vec{u}-2\vec{u}_{\vec{n}}</me>
                On effectue ensuite tous les calculs sur Sage pour trouver les images des trois vecteurs. On rappelle la formule <xref ref="eq-projortho"/> pour la projection.</p>
                <listing>
                   <caption>Le code solution pour l'exercice</caption>
               <program language="sage">
               <input>
i=vector([1,0,0])
j=vector([0,1,0])
k=vector([0,0,1])
n=vector([8,1,6])
Ti=i-2*((i*n)/(n*n))*n #la réflexion de (1,0,0) sur le plan, qui utilise la projection orthogonale
Tj=j-2*((j*n)/(n*n))*n
Tk=k-2*((k*n)/(n*n))*n
T=column_matrix([Ti,Tj,Tk]) #on met les résultats en colonnes pour obtenir T
show(T)
               </input>
               </program>
               </listing>
               <p>La matrice de <m>T</m> est donc bel et bien:
                   <me>T=T=\begin{pmatrix}-\frac{27}{101}&amp;-\frac{16}{101}&amp;-\frac{96}{101}\\-\frac{16}{101}&amp;\frac{99}{101}&amp;-\frac{12}{101}\\ 
                   -\frac{96}{101}&amp;-\frac{12}{101}&amp;\frac{29}{101}\end{pmatrix}</me>
            </p>
            </solution>
            </task>
    </exercise>
    
    <exercise>
    <introduction><p>On s'intéresse à la matrice d'un étirement quelconque dans <m>\R^3</m>. Un étirement de direction <m>\vec{n}</m> et de facteur <m>k</m> est une
    transformation linéaire <m>E_{\vec{n},k}</m> telle que <m>E_{\vec{n},k}(\vec{n})=k\vec{n}</m> et <m>E_{\vec{n},k}(\vec{u})=\vec{u}</m> pour tout vecteur <m>\vec{u}</m>
    tels que <m>\vec{n}\cdot \vec{u}=0</m></p></introduction>
    <task>
    <statement>
    <p>Quels sont les vecteurs qui demeurent inchangés par l'étirement.</p>
    </statement>
    <answer><p>Ce sont les vecteurs perpendiculaires à <m>\vec{n}</m>, donc ceux dans le plan <m>\vec{n}\cdot (x,y,z)=0</m>.</p></answer></task>
    <task>
    <statement><p>Déterminer la matrice d'un étirement dans la direction <m>\vec{n}=(1,3,5)</m> de facteur <m>k=\frac{1}{2}</m>.</p>
    <sage>
    <input>
    
    </input>
    </sage>
    </statement>
    <answer>
    <p><me>
    T=\begin{pmatrix}
\frac{69}{70} &amp; -\frac{3}{70} &amp; -\frac{1}{14} \\
-\frac{3}{70} &amp; \frac{61}{70} &amp; -\frac{3}{14} \\
-\frac{1}{14} &amp; -\frac{3}{14} &amp; \frac{9}{14}
\end{pmatrix}
    </me></p>
    </answer>
    <solution>
    <listing>
                   <caption>Le code solution pour l'exercice</caption>
               <program language="sage">
               <input>
var("x,y,z")
#Recherche de vecteurs perpendiculaires à n
n=vector([1,3,5])
sol=solve(n*vector([x,y,z])==0,x,y,z,solution_dict=True)
l=[] #Liste vide des variables libres
for v in sol[0].keys():  # vérifier ce que sol[0].keys() donne pour comprendre cette étape
    for var in sol[0][v].variables():  #Vérifier aussi cette étape
        if var not in l:   #On ne veut pas que les variables soient la plusieurs fois
            l.append(var)
u=vector([sol[0][x],sol[0][y],sol[0][z]]).subs({l[0]:1,l[1]:0})
v=vector([sol[0][x],sol[0][y],sol[0][z]]).subs({l[0]:0,l[1]:1})  #Ceci crée deux vecteurs non parallèles qui seront nos vecteurs directeurs.
#Recherche de la matrice de transformation
k=1/2
U=column_matrix([n,u,v])
V=column_matrix([k*n,u,v])
T=V*(U.inverse())
show(T)
               </input>
                   </program>
                   </listing> 
    </solution>
    </task>
    <task><statement><p>Adapter la fonction de la partie précédente pour créer ue fonction <c>etirR3</c>, similaire à celle développée à l'exercice <xref ref="exosage-etirquelcR2"/>,
    qui détermine la matrice d'un étirement dans la direction <m>\vec{n}=(n1,n2,n3)</m> et 
    de facteur <m>k</m>. Vérifier la solution avec l'exercice précédent.</p></statement>
    <solution>
     <listing>
                   <caption>Le code solution pour l'exercice</caption>
               <program language="sage">
               <input>
var("x,y,z,n1,n2,n3,k")
#Recherche de vecteurs perpendiculaires à n
def etirR3(n,k):
    sol=solve(n*vector([x,y,z])==0,x,y,z,solution_dict=True)
    l=[] #Liste vide des variables libres
    for v in sol[0].keys():  # vérifier ce que sol[0].keys() donne pour comprendre cette étape
        for var in sol[0][v].variables():  #Vérifier aussi cette étape
            if var not in l and var not in [n1,n2,n3]:   #On ne veut pas que les variables soient la plusieurs fois
                l.append(var)
    u=vector([sol[0][x],sol[0][y],sol[0][z]]).subs({l[0]:1,l[1]:0})
    v=vector([sol[0][x],sol[0][y],sol[0][z]]).subs({l[0]:0,l[1]:1})  #Ceci crée deux vecteurs non parallèles qui seront nos vecteurs directeurs.
    #Recherche de la matrice de transformation
    U=column_matrix([n,u,v])
    V=column_matrix([k*n,u,v])
    T=V*(U.inverse())
    return T
show(etirR3(vector([1,3,5]),1/2))
show(etirR3(vector([n1,n2,n3]),k).simplify_full())
               </input>
                   </program>
                   </listing>    
    </solution>
    </task>
    </exercise>
    <exercise>
    <statement>
    <p>En continuant l'esprit de l'exercice <xref ref="exo-invspecial"/>, vérifier que la réponse donnée correspond bien pour les matrices
    <me>A=\begin{pmatrix} 1&amp; 0&amp; 0&amp; 0 \\ 1&amp; 1&amp; 0&amp; 0 \\ 1&amp; 1&amp; 1&amp; 0 \\ 1&amp; 1&amp; 1&amp; 1 \end{pmatrix}</me>
    et
    <me>B=\begin{pmatrix} 1&amp; 0&amp; 0&amp; 0&amp; 0 \\ 1&amp; 1&amp; 0&amp; 0&amp; 0\\ 1&amp; 1&amp; 1&amp; 0&amp; 0\\ 1&amp; 1&amp; 1&amp; 1&amp; 0\\ 1&amp; 1&amp; 1&amp; 1&amp; 1 \end{pmatrix}</me>.</p>
    <sage>
    <input>
    
    </input>
    </sage>
    </statement>
    </exercise>
    </exercisegroup>
</exercises>
<!--exo similaire pour une matrice colonne 11111..., 02222...,00333...,....00...0n -->
<!--Trouver axe de rotation avec Ru-u perpendiculaire à axe (avec prod vec?-->
